/*****************************************************************************
                                                                              
         This file is a part of PSD (Parallel Structural Dynamics)            
                                                                              
     -------------------------------------------------------------------      
                                                                              
     Author(s): Mohd Afeef Badri                                              
     Email    : mohd-afeef.badri@cea.fr                                       
     Date     : 2021‑07‑29                                                    
     Comment  : This test checks the MFrontParameter routine provided
                in the mfront plugin of PSD works well
                                                                                              
     -------------------------------------------------------------------      
                                                                              
     PSD a parallel  finite  element framework  provides tools to  solve      
     multiple  solid-dynamic  problems; PSD is distributed  in  the hope      
     that it will be useful, but WITHOUT ANY WARRANTY; or  without  even      
     the implied warranty of  FITNESS  FOR  A  PARTICULAR  PURPOSE.           
                                                                              
*******************************************************************************/                                                                                                                                                                                                                                     
  load    "../cpp/mfront"

  load    "Element_QF"                           // Quadrature elements     
  
  mesh Th = square(2,2);
  fespace Qh  ( Th , [FEQF2,FEQF2,FEQF2,FEQF2,FEQF2,FEQF2] );
  Qh [Mt11,Mt12,Mt13,Mt22,Mt23,Mt33];

  fespace Sh  ( Th , [FEQF2,FEQF2,FEQF2] );
  Sh [Eps11,Eps22,Eps12];  
  
    
  plot(Th);
  cout << "Material tensore FreeFem has " << Qh.ndof << endl;
  string    PropertyNames   = "YoungModulus PoissonRatio";
  real[int] PropertyValues  = [ 15e9, 0.3   ];  
  
  mfrontElasticityHandler( "Elasticity", 
                           mfrontBehaviourHypothesis = "GENERALISEDPLANESTRAIN",
                           mfrontPropertyNames       = PropertyNames           ,
                           mfrontPropertyValues      = PropertyValues          ,
                           mfrontMaterialTensor      = Mt11[]                  ,
                           mfrontStrainTensor        = Eps11[]                                     
                         );

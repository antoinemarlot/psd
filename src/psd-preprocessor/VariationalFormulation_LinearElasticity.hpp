//=================================================================================================
// ------ Building the VariationalFormulations.edp file ------
//=================================================================================================


 writeIt
 "                                                                                                \n"
 "//==============================================================================                \n"
 "// -------Variation formulation linear elasticity-------                                        \n"
 "//==============================================================================                \n"
 "                                                                                                \n"
 "                                                                                                \n"
 "varf elast(def(u),def(v)) =                                                                     \n"
 "                                                                                                \n";

if(fastmethod)
 writeIt
 "    //--------------------------------------------------------------------------                \n"
 "    //  $+int_{\\Omega}(\\lambda:\\nabla(u).\\nabla(v))$                                        \n"
 "    //  $+int_{\\Omega}(2\\mu(\\epsilon(u):\\epsilon(v)))$                                      \n"
 "    //--------------------------------------------------------------------------                \n"
 "      intN(Th,qforder=3)(                                                                       \n"
 "                     lambda*divergence(u)*divergence(v)                                         \n"
 "                   + 2.*mu*( epsilon(u)'*epsilon(v) )                                           \n";

if(!fastmethod)
 writeIt
 "    //--------------------------------------------------------------------------                \n"
 "    //  $+int_{\\Omega}(\\epsilon(u):\\mathbbm(E):\\epsilon(v))$                                \n"
 "    //--------------------------------------------------------------------------                \n"
 "      intN(Th,qforder=3)(                                                                       \n"
 "                     epsilon(u)'*Mt*epsilon(v)                                                  \n";


 writeIt
 "                     )                                                                          \n";

for(int i=0; i<bodyforceconditions; i++)
 writeIt
 "                                                                                                \n"
 "    //--------------------------------------------------------------------------                \n"
 "    //  $+int_{\\Omega}(f.v)$                                                                   \n"
 "    //--------------------------------------------------------------------------                \n"
 "     + intN(Th,Fbc"<<i<<"On,qforder=3)(BodyforceBc"<<i<<")                                      \n";

for(int i=0; i<tractionconditions; i++)
 writeIt
 "                                                                                                \n"
 "    //--------------------------------------------------------------------------                \n"
 "    //  $+int_{\\partial\\Omega_N}(T.v)$                                                        \n"
 "    //--------------------------------------------------------------------------                \n"
 "     + intN1(Th,Tbc"<<i<<"On,qforder=3)(NeumannBc"<<i<<")                                       \n";

for(int i=0; i<dirichletconditions; i++)
 writeIt
 "                                                                                                \n"
 "    //--------------------------------------------------------------------------                \n"
 "    //  $\\forall x\\in\\partial\\Omega_D u=ug: ug\\to\\mathbb R$                               \n"
 "    //--------------------------------------------------------------------------                \n"
 "      + on (Dbc"<<i<<"On,DirichletBc"<<i<<")                                                    \n";



 writeIt
 ";                                                                                               \n"
<<"                                                                                                \n";
